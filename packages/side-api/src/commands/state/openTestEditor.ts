import set from 'lodash/fp/set'
import { getActiveCommandIndex } from '../../helpers/getActiveData'
import { EditorStateShape } from '../../models/state'
import { Mutator } from '../../types'

export type Shape = () => Promise<void>
/**
 * Called whenever test editor opens. Assigns command indexes
 */
export type EditorUpdates = Pick<EditorStateShape, 'selectedCommandIndexes'>
export type StateUpdates = { editor: EditorUpdates }

export const mutator: Mutator = (session) =>
  set(
    'state.editor.selectedCommandIndexes',
    [getActiveCommandIndex(session)],
    session
  )
